name: Fetch Daily News for Typing Game

on:
  workflow_dispatch: # 手動実行を許可
  schedule:
    - cron: '0 0 * * *' # 毎日午前0時 (UTC) に実行

jobs:
  fetch:
    runs-on: ubuntu-latest
    # jqコマンドをインストールしてから実行
    container:
      image: ubuntu:latest
      entrypoint: /bin/bash
    steps:
      - name: Install dependencies
        run: apt-get update && apt-get install -y curl jq git
      - uses: actions/checkout@v4
      - name: Fetch news and update file
        run: |
          API_KEY="b35f9afdc84845b782d4120453db88ea" # ★あなたのキーに置き換える
          curl -s "https://newsapi.org" | jq -r '.[].articles | .[].content' > news_data.txt
      - name: Commit files
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add news_data.txt
          git commit -m "Update daily news text"
          git push
