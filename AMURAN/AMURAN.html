<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ã‚¢ãƒŸãƒ¥ãƒ©ãƒ³ç©ºä¸­æ•£æ­© ğŸ¡</title>
    <link rel="icon" href="WorldNow_favicon.ico">
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: sans-serif; color: white; }
        
        /* 1. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ */
        #menu-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://www.amu-kagoshima.com');
            background-size: cover; background-position: center;
            z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* 2. å‡ºç™ºæ¼”å‡ºï¼ˆã‚¿ã‚¤ãƒˆãƒ«éš ã—ç”¨ï¼‰ */
        #loading-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 90; display: none; align-items: center; justify-content: center;
            transition: opacity 2s ease; pointer-events: none;
        }

        /* 3. å»ºç‰©ã«å¸ã„ä»˜ããƒ©ãƒ™ãƒ« */
        #floating-label {
            position: absolute; z-index: 20; display: none; flex-direction: column; align-items: center;
            transition: all 0.8s ease-out; pointer-events: none; transform: translateX(-50%);
        }
        .label-content { background: rgba(255, 71, 87, 0.9); padding: 6px 15px; border-radius: 20px; font-weight: bold; white-space: nowrap; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        .label-line { width: 2px; height: 20px; background: white; }

        /* 4. UIãƒ‘ãƒ¼ãƒ„ */
        #video-wrapper { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        #info-tooltip { position: absolute; top: 20px; right: 20px; z-index: 10; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.3); min-width: 200px; display: none; }
        .back-button { position: absolute; top: 20px; left: 20px; z-index: 110; color: white; text-decoration: none; background: rgba(0,0,0,0.5); padding: 10px; border-radius: 5px; }
        
        .menu-box { background: rgba(0,0,0,0.85); padding: 40px; border-radius: 20px; text-align: center; }
        #start-btn { padding: 18px 60px; font-size: 20px; border-radius: 50px; border: none; background: #ff4757; color: white; cursor: pointer; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>

    <div id="menu-screen">
        <div class="menu-box">
            <h1>ğŸ¡ ã‚¢ãƒŸãƒ¥ãƒ©ãƒ³ç©ºä¸­æ•£æ­©ä½“é¨“</h1>
            <p>2:20é ƒã‹ã‚‰æ™¯è‰²ãŒåºƒãŒã‚Šå§‹ã‚ã¾ã™</p>
            <button id="start-btn">ä¹—è»Šã™ã‚‹ (Start)</button>
        </div>
    </div>

    <div id="loading-overlay"><div>ğŸ¡ ã¾ã‚‚ãªãå‡ºç™ºã—ã¾ã™...</div></div>

    <div id="floating-label">
        <div class="label-content"><span id="l-icon">ğŸ“</span> <span id="l-name">å»ºç‰©</span></div>
        <div class="label-line"></div>
    </div>

    <div id="info-tooltip">
        <div style="font-size: 11px; opacity: 0.7;">ç¾åœ¨ã®çŠ¶æ³</div>
        <div id="status-text">å‡ºç™ºæº–å‚™ä¸­...</div>
        <div id="altitude-text" style="font-weight: bold; margin-top:5px;">æ¨™é«˜: --- m</div>
    </div>

    <a href="../index.html" class="back-button">â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>

    <div id="video-wrapper"><div id="player"></div></div>

    <script>
        // APIã‚’å‹•çš„ã«ãƒ­ãƒ¼ãƒ‰
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        document.body.appendChild(tag);

        let player;
        let isStarted = false;

        document.getElementById('start-btn').addEventListener('click', () => {
            if (isStarted) return;
            isStarted = true;

            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æ¶ˆã—ã€é»’å¹•ã‚’è¡¨ç¤º
            document.getElementById('menu-screen').style.opacity = '0';
            setTimeout(() => { document.getElementById('menu-screen').style.display = 'none'; }, 1000);
            
            const lo = document.getElementById('loading-overlay');
            lo.style.display = 'flex';

            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½œæˆ
            player = new YT.Player('player', {
                height: '100%', width: '100%', videoId: 'uX8g9pbRnIA',
                playerVars: { 
                    'start': 55, 'controls': 0, 'disablekb': 1, 'modestbranding': 1, 
                    'rel': 0, 'autoplay': 1, 'mute': 1, 
                    'origin': window.location.protocol + '//' + window.location.hostname 
                },
                events: { 
                    'onReady': (e) => { 
                        e.target.playVideo(); 
                        setInterval(updateUI, 1000);
                        
                        // ã€ã“ã“ãŒé‡è¦ã€‘å†ç”Ÿåˆå›³ã‚’å¾…ãŸãšã€æº–å‚™å®Œäº†ã‹ã‚‰4ç§’å¾Œã«ç¢ºå®Ÿã«å¹•ã‚’æ¶ˆã™
                        setTimeout(hideOverlay, 4000);
                    }
                }
            });
        });

        function hideOverlay() {
            const lo = document.getElementById('loading-overlay');
            if (lo && lo.style.display !== 'none') {
                lo.style.opacity = '0';
                document.getElementById('info-tooltip').style.display = 'block';
                setTimeout(() => lo.style.display = 'none', 2000);
            }
        }

        function updateUI() {
            if (!player || !player.getCurrentTime) return;
            const time = player.getCurrentTime();
            const status = document.getElementById('status-text');
            const alt = document.getElementById('altitude-text');
            const label = document.getElementById('floating-label');
            const lName = document.getElementById('l-name');

            // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—æ›´æ–°
            if (time < 140) { status.innerText = "ã¾ã‚‚ãªãæ™¯è‰²ãŒè¦‹ãˆã¾ã™"; alt.innerText = "æ¨™é«˜: ä¸Šæ˜‡ä¸­..."; }
            else if (time < 440) { status.innerText = "è¡—ä¸¦ã¿ãŒä¸€æœ›ã§ãã¾ã™"; alt.innerText = "æ¨™é«˜: ç´„ 60 m"; }
            else if (time < 510) { status.innerText = "æœ€é«˜åœ°ç‚¹ï¼æ¡œå³¶ãŒæ­£é¢ã§ã™"; alt.innerText = "æ¨™é«˜: 91 m"; }
            else { status.innerText = "ã‚†ã£ãã‚Šä¸‹é™ã—ã¦ã„ã¾ã™"; alt.innerText = "æ¨™é«˜: ä¸‹é™ä¸­..."; }

            // å»ºç‰©ãƒ©ãƒ™ãƒ«ç§»å‹•
            if (time >= 145 && time < 260) {
                showLabel(label, lName, "é¹¿å…å³¶ä¸­å¤®é§… ğŸš„", "25%", (65 + (time-145)*0.1) + "%");
            } else if (time >= 430 && time < 510) {
                showLabel(label, lName, "æ¡œå³¶ ğŸŒ‹", "50%", "45%");
            } else if (time >= 620 && time < 750) {
                showLabel(label, lName, "åŸå±± â›°ï¸", "75%", (40 + (time-620)*0.05) + "%");
            } else {
                label.style.display = 'none';
            }
        }

        function showLabel(el, nameEl, text, x, y) {
            el.style.display = 'flex';
            nameEl.innerText = text;
            el.style.left = x;
            el.style.top = y;
        }
    </script>
</body>
</html>
